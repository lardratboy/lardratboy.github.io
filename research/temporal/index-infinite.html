<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temporal Text Editor V3 - Infinite Grid</title>
    <link rel="stylesheet" href="css/styles-enhanced.css">
</head>
<body>
    <div class="container">
        <h1>‚è± THE TEMPORAL TEXT EDITOR V3 ‚è±</h1>
        <div class="subtitle">
            When Time Becomes Editable - <span class="version-badge">Infinite Grid Edition</span>
        </div>

        <div class="instructions">
            <h3>Quick Start Guide:</h3>
            <ul>
                <li><strong>Type normally</strong> - Each keystroke is recorded with a timestamp</li>
                <li><strong>Enter/Return</strong> - Move cursor to start of next line</li>
                <li><strong>Drag timeline</strong> - Scrub backwards through time</li>
                <li><strong>Click grid</strong> - Teleport cursor (no event recorded)</li>
                <li><strong>Type while scrubbed</strong> - Creates concurrent edits that interleave with history</li>
                <li><strong>Arrow keys</strong> - Move cursor (recorded in timeline)</li>
                <li><strong>Toggle Insert Mode button or Insert key</strong> - Switch between INSERT (|) and OVERWRITE (‚ñà) modes</li>
                <li><strong>Backspace/Delete</strong> - Remove characters (behavior depends on mode)</li>
            </ul>
            <div class="try-this">
                <strong>Try this:</strong> Type "HELLO", drag timeline to start, click row 5, type "WORLD" - watch them alternate!
            </div>
            <div class="try-this" style="color: #0ff; margin-top: 5px;">
                <strong>New in V3:</strong> Playback controls, auto-save, pattern analysis, timeline branches, macros, multi-cursor visualization!
            </div>
        </div>

        <div class="editor-container">
            <canvas id="editor-canvas"></canvas>
            <div class="minimap-container">
                <h4>Minimap</h4>
                <canvas id="minimap-canvas"></canvas>
            </div>
        </div>

        <!-- Branch Management UI Container -->
        <div id="branch-ui-container-wrapper"></div>

        <!-- Color Picker Container -->
        <div id="color-picker-container-wrapper"></div>

        <!-- Annotation UI Container -->
        <div id="annotation-ui-container"></div>

        <div class="playback-controls">
            <h3>‚èØ Playback Controls</h3>
            <div class="playback-buttons">
                <button id="playback-play">‚ñ∂ Play</button>
                <button id="playback-pause">‚è∏ Pause</button>
                <button id="playback-stop">‚èπ Stop</button>
                <button id="playback-step-back">‚èÆ Step Back</button>
                <button id="playback-step-forward">‚è≠ Step Forward</button>
                <button id="playback-loop">üîÅ Loop</button>
                <label>
                    Speed:
                    <select id="playback-speed">
                        <option value="0.25">0.25x</option>
                        <option value="0.5">0.5x</option>
                        <option value="1" selected>1x</option>
                        <option value="2">2x</option>
                        <option value="4">4x</option>
                    </select>
                </label>
            </div>
        </div>

        <div class="timeline-container">
            <div class="timeline-label">Timeline (drag to scrub through time)</div>
            <div class="timeline" id="timeline">
                <div class="timeline-playhead" id="playhead"></div>
            </div>
        </div>

        <div class="status-bar" id="status-bar">
            <div class="status-item">
                <span>Mode:</span>
                <span class="mode-indicator mode-live" id="mode-indicator">LIVE</span>
            </div>
            <div class="status-item">
                <span>Insert Mode:</span>
                <span class="insert-mode" id="insert-mode-indicator">INSERT (|)</span>
            </div>
            <div class="status-item">
                <span>Time:</span>
                <span class="time-display" id="time-display">0ms / 0ms</span>
            </div>
            <div class="status-item">
                <span>Cursor:</span>
                <span class="time-display" id="cursor-display">(0, 0)</span>
            </div>
            <div class="status-item">
                <span>Events:</span>
                <span class="time-display" id="event-count">0</span>
            </div>
        </div>

        <div class="controls">
            <h3>üõ† Controls</h3>

            <div class="control-section">
            <div class="control-section">
                <h4>Navigation & Viewport</h4>
                <div class="control-buttons">
                    <button id="pan-up">‚¨Ü Pan Up</button>
                    <button id="pan-down">‚¨á Pan Down</button>
                    <button id="pan-left">‚¨Ö Pan Left</button>
                    <button id="pan-right">‚û° Pan Right</button>
                    <button id="center-cursor">üéØ Center on Cursor</button>
                    <button id="zoom-in">üîç+ Zoom In</button>
                    <button id="zoom-out">üîç- Zoom Out</button>
                    <button id="zoom-reset">‚Ü∫ Reset Zoom</button>
                </div>
            </div>


                <h4>Basic Operations</h4>
                <div class="control-buttons">
                    <button id="toggle-insert-mode-btn" style="background: #05a; color: #fff; font-weight: bold;">‚å®Ô∏è Toggle Insert Mode</button>
                    <button id="undo-btn" title="Undo (Ctrl+Z)">‚Ü∂ Undo</button>
                    <button id="redo-btn" title="Redo (Ctrl+Y)">‚Ü∑ Redo</button>
                    <button id="clear-btn" class="danger">Clear All</button>
                    <button id="help-btn">Toggle Instructions</button>
                </div>
                <div style="color: #888; font-size: 11px; margin-top: 5px;">
                    <strong>Keyboard:</strong> Ctrl+Z (Undo), Ctrl+Y (Redo), Ctrl+C (Copy), Ctrl+V (Paste), Ctrl+B (Bookmark), Shift+Arrows (Select)
                </div>
            </div>

            <div class="control-section">
                <h4>Import / Export</h4>
                <div class="control-buttons">
                    <button id="import-json-btn" style="background: #0a5; color: #000; font-weight: bold;">üìÅ Import JSON</button>
                    <button id="export-json-btn">üíæ Export JSON</button>
                    <button id="export-csv-btn">üìÑ Export CSV</button>
                    <button id="export-asciinema-btn">üé¨ Export Asciinema (.cast)</button>
                </div>
            </div>

            <div class="control-section">
                <h4>Persistence (Auto-save enabled)</h4>
                <div class="control-buttons">
                    <button id="save-btn">Save State</button>
                    <button id="load-btn">Load State</button>
                </div>
            </div>

            <div class="control-section">
                <h4>Analysis & Visualization</h4>
                <div class="control-buttons">
                    <button id="analyze-btn">Analyze Patterns</button>
                    <button id="multicursor-toggle">Toggle Multi-Cursor</button>
                </div>
            </div>

            <div class="control-section">
                <h4>Advanced Features</h4>
                <div style="color: #0a0; font-size: 11px; margin-top: 5px;">
                    <p><strong>üåø Branches:</strong> Use the Branch Management panel above to create, switch, merge, and delete branches!</p>
                    <p><strong>Macros (Console):</strong> editor.startRecording("name"), editor.saveMacro(), editor.replayMacro("name")</p>
                    <p><strong>Drafts (Console):</strong> editor.saveDraft("name"), editor.loadDraft("name"), editor.listDrafts()</p>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Temporal Text Editor V3.0 - Enhanced Edition</p>
            <p>Event Sourcing ‚Ä¢ Time Travel ‚Ä¢ Concurrent Editing ‚Ä¢ Playback ‚Ä¢ Analysis</p>
            <p>Open browser console for debug logs and advanced API access (window.editor)</p>
            <p style="margin-top: 5px;">
                <a href="index.html">Basic Version</a> |
                <a href="temporal-editor-v1.html">V1 (Single File)</a> |
                <a href="README.md">Documentation</a>
            </p>
        </div>
    </div>

    <script type="module" src="js/main-infinite.js"></script>
</body>
</html>
